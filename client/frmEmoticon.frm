VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmEmoticon 
   BackColor       =   &H00FFFFFF&
   BorderStyle     =   0  'None
   Caption         =   "Form1"
   ClientHeight    =   1095
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   3255
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   1095
   ScaleWidth      =   3255
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows Default
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   27
      Left            =   2880
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   27
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   26
      Left            =   2520
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   26
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   25
      Left            =   2160
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   25
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   24
      Left            =   1800
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   24
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   23
      Left            =   1440
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   23
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   22
      Left            =   1080
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   22
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   21
      Left            =   720
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   21
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   20
      Left            =   360
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   20
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   19
      Left            =   0
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   19
      Top             =   720
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   18
      Left            =   2880
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   18
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   17
      Left            =   2520
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   17
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   16
      Left            =   2160
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   16
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   15
      Left            =   1800
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   15
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   14
      Left            =   1440
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   14
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   13
      Left            =   1080
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   13
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   12
      Left            =   720
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   12
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   11
      Left            =   360
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   11
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   10
      Left            =   0
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   10
      Top             =   360
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   9
      Left            =   2880
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   9
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   8
      Left            =   2520
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   8
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   7
      Left            =   2160
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   7
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   6
      Left            =   1800
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   6
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   5
      Left            =   1440
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   5
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   4
      Left            =   1080
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   4
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   3
      Left            =   720
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   3
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   2
      Left            =   360
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   2
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picEmoticon 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      ForeColor       =   &H80000000&
      Height          =   375
      Index           =   1
      Left            =   0
      ScaleHeight     =   375
      ScaleWidth      =   375
      TabIndex        =   1
      Top             =   0
      Width           =   375
   End
   Begin VB.PictureBox picTemp 
      Height          =   375
      Left            =   3120
      ScaleHeight     =   315
      ScaleWidth      =   555
      TabIndex        =   0
      Top             =   600
      Visible         =   0   'False
      Width           =   615
   End
   Begin MSComctlLib.ImageList imglstSmiley2 
      Left            =   3240
      Top             =   600
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   53
      ImageHeight     =   24
      MaskColor       =   16777215
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   20
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":0000
            Key             =   "guns"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":0992
            Key             =   "finger"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":1000
            Key             =   "alien"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":1646
            Key             =   "smash"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":1DF8
            Key             =   "king"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":245A
            Key             =   "hi"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":2A50
            Key             =   "light"
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":2F92
            Key             =   "guitar"
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":364C
            Key             =   "ass"
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":3C6A
            Key             =   "crap"
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":4394
            Key             =   "shoot"
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":4B06
            Key             =   "toiletattack"
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":5408
            Key             =   "bored"
         EndProperty
         BeginProperty ListImage14 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":5BCA
            Key             =   "angel"
         EndProperty
         BeginProperty ListImage15 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":6364
            Key             =   "moose"
         EndProperty
         BeginProperty ListImage16 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":6B36
            Key             =   "thirsty"
         EndProperty
         BeginProperty ListImage17 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":72A8
            Key             =   "devil"
         EndProperty
         BeginProperty ListImage18 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":78DA
            Key             =   "puppy"
         EndProperty
         BeginProperty ListImage19 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":7E6C
            Key             =   "grim"
         EndProperty
         BeginProperty ListImage20 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":849E
            Key             =   "rocket"
         EndProperty
      EndProperty
   End
   Begin MSComctlLib.ImageList imglstSmiley 
      Left            =   3120
      Top             =   0
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   16777215
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   27
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":9248
            Key             =   "smile"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":97C6
            Key             =   "wink"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":9D44
            Key             =   "widesmile"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":A2C2
            Key             =   "tongue"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":A840
            Key             =   "sad"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":ADBE
            Key             =   "angry"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":B33C
            Key             =   "confused"
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":B946
            Key             =   "smoking"
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":BF00
            Key             =   "cool"
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":C47E
            Key             =   "ignoring"
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":C9FC
            Key             =   "baby"
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":CFA2
            Key             =   "realsad"
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":D520
            Key             =   "realangry"
         EndProperty
         BeginProperty ListImage14 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":DA9E
            Key             =   "love"
         EndProperty
         BeginProperty ListImage15 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":E01C
            Key             =   "realconfused"
         EndProperty
         BeginProperty ListImage16 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":E59A
            Key             =   "messedup"
         EndProperty
         BeginProperty ListImage17 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":EB2C
            Key             =   "lol"
         EndProperty
         BeginProperty ListImage18 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":F0AA
            Key             =   "scared"
         EndProperty
         BeginProperty ListImage19 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":F628
            Key             =   "freak"
         EndProperty
         BeginProperty ListImage20 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":FBBA
            Key             =   "poop"
         EndProperty
         BeginProperty ListImage21 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":1010C
            Key             =   "cry"
         EndProperty
         BeginProperty ListImage22 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":1069E
            Key             =   "crosseyes"
         EndProperty
         BeginProperty ListImage23 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":10C1C
            Key             =   "realfreak"
         EndProperty
         BeginProperty ListImage24 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":1116E
            Key             =   "clown"
         EndProperty
         BeginProperty ListImage25 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":116EC
            Key             =   "cat"
         EndProperty
         BeginProperty ListImage26 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":11CEE
            Key             =   "scary"
         EndProperty
         BeginProperty ListImage27 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmEmoticon.frx":12240
            Key             =   "surprised"
         EndProperty
      EndProperty
   End
End
Attribute VB_Name = "frmEmoticon"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Declare Function Rectangle Lib "gdi32" (ByVal hdc As Long, ByVal X1 As Long, ByVal Y1 As Long, ByVal X2 As Long, ByVal Y2 As Long) As Long

Dim iOldIndex As Integer
Dim iOldMouseX As Integer
Dim iOldMouseY As Integer
Dim iXOld As Integer
Dim iYOld As Integer

Dim Textbox As RichTextBox

Public Sub textboxSet(text As RichTextBox)
Set Textbox = text
End Sub

Private Sub Form_Deactivate()
Unload Me
End Sub

Private Sub Form_Activate()

Dim i As Integer, iX As Integer, iY As Integer, iPicW As Integer, iPicH As Integer
For i = 1 To 27 ' all small emoticons
    'picEmoticon(i).BackColor = vbWhite
    'picEmoticon(i).BorderStyle = 0
    'picEmoticon(i).AutoRedraw = true
    picEmoticon(i).ToolTipText = "(" & imglstSmiley.ListImages(i).Key & ")"
    iPicW = imglstSmiley.ListImages(i).Picture.Width
    iPicH = imglstSmiley.ListImages(i).Picture.Height
    
    iX = (picEmoticon(i).Width / 2) - (iPicW / 4)
    If iX < 0 Then
    iX = (iPicW / 2) - (picEmoticon(i).Width / 2)
    End If
    
    iY = (picEmoticon(i).Height / 2) - (iPicH / 4)
    If iY < 0 Then
    iY = (iPicH / 2) - (picEmoticon(i).Height / 2)
    End If
    
        imglstSmiley.ListImages(i).Draw picEmoticon(i).hdc, iX, iY, 1
        picEmoticon(i).ForeColor = &H8000000C
        Call Rectangle(picEmoticon(i).hdc, 0, 0, Me.ScaleX(picEmoticon(i).Width, 1, 3), Me.ScaleY(picEmoticon(i).Height, 1, 3))
Next i


picEmoticon(1).SetFocus
End Sub

Private Sub Form_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
If iOldIndex = 0 Then
    If iOldIndex = 0 Then
        picEmoticon(1).SetFocus
    Else
        picEmoticon(iOldIndex).SetFocus
    End If
Exit Sub
End If

    iPicW = imglstSmiley.ListImages(iOldIndex).Picture.Width
    iPicH = imglstSmiley.ListImages(iOldIndex).Picture.Height
    iX = (picEmoticon(iOldIndex).Width / 2) - (iPicW / 4)
    If iX < 0 Then iX = (iPicW / 2) - (picEmoticon(iOldIndex).Width / 2)
    iY = (picEmoticon(iOldIndex).Height / 2) - (iPicH / 4)
    If iY < 0 Then iY = (iPicH / 2) - (picEmoticon(iOldIndex).Height / 2)
        
    picEmoticon(iOldIndex).BackColor = vbWhite 'check for first time hover
    imglstSmiley.ListImages(iOldIndex).Draw picEmoticon(iOldIndex).hdc, iX, iY, 1
'    picEmoticon(iOldIndex).Line (picEmoticon(iOldIndex).Width - 10, 10)-(picEmoticon(iOldIndex).Width - 10, picEmoticon(iOldIndex).Height - 10) 'right line
'    picEmoticon(iOldIndex).Line (10, 10)-(picEmoticon(iOldIndex).Width - 10, 10) 'top line
    
'    picEmoticon(1).Line (10, 10)-(10, picEmoticon(1).Height - 10) 'left line
'    picEmoticon(10).Line (10, 10)-(10, picEmoticon(10).Height - 10) 'left line
'    picEmoticon(19).Line (10, 10)-(10, picEmoticon(19).Height - 10) 'left line
    'draw the last one's border
    Call Rectangle(picEmoticon(iOldIndex).hdc, 0, 0, Me.ScaleX(picEmoticon(iOldIndex).Width, 1, 3), Me.ScaleY(picEmoticon(iOldIndex).Height, 1, 3))
    iOldIndex = 0
End Sub

Private Sub picEmoticon_Click(index As Integer)
'check before adding this
If Options.TextLeft - Len(imglstSmiley.ListImages(index).Key) - 2 < 0 Then 'Len("(" & imglstSmiley.ListImages(Index).Key & ")") < 0 Then
    'do not let him insert it
    Beep
    'lock the txtsend, and only allow backspaces
'    frmMain.txtSend.Locked = True
Else
    Options.Temp = imglstSmiley.ListImages(index).Key
    InsertPicture Textbox, imglstSmiley.ListImages(index).Picture, Options.Temp
End If

Unload Me
End Sub

Private Sub picEmoticon_KeyDown(index As Integer, KeyCode As Integer, Shift As Integer)
Select Case KeyCode
    Case Is = 27 'Esc
        Unload Me
        frmServer.txtSend.SetFocus
    Case Is = 37 'left
        If index - 1 >= picEmoticon.LBound Then
        Call picEmoticon_MouseMove(index - 1, 15, 0, 0, 0)
        picEmoticon(index - 1).SetFocus
        End If
    Case Is = 38 'up
        If index - 9 >= picEmoticon.LBound Then
        Call picEmoticon_MouseMove(index - 9, 15, 0, 0, 0)
        picEmoticon(index - 9).SetFocus
        End If
    Case Is = 39 'right
        If index + 1 <= picEmoticon.UBound Then
        Call picEmoticon_MouseMove(index + 1, 15, 0, 0, 0)
        picEmoticon(index + 1).SetFocus
        End If
    Case Is = 40 'down
        If index + 9 <= picEmoticon.UBound Then
        Call picEmoticon_MouseMove(index + 9, 15, 0, 0, 0)
        picEmoticon(index + 9).SetFocus
        End If
    Case Is = 13 'enter
        Call picEmoticon_Click(index)
    Case Is = 32 'space
        Call picEmoticon_Click(index)
End Select
'MsgBox KeyCode
End Sub

Private Sub picEmoticon_MouseDown(index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
If picEmoticon(index).BackColor = &HC00000 Then Exit Sub

Dim iX As Integer, iY As Integer, iPicW As Integer, iPicH As Integer
iPicW = imglstSmiley.ListImages(index).Picture.Width
iPicH = imglstSmiley.ListImages(index).Picture.Height
iX = (picEmoticon(index).Width / 2) - (iPicW / 4)
If iX < 0 Then iX = (iPicW / 2) - (picEmoticon(index).Width / 2)
iY = (picEmoticon(index).Height / 2) - (iPicH / 4)
If iY < 0 Then iY = (iPicH / 2) - (picEmoticon(index).Height / 2)

picEmoticon(index).BackColor = &HC00000 'dark blue
imglstSmiley.ListImages(index).Draw picEmoticon(index).hdc, iX, iY, 1

Call Rectangle(picEmoticon(index).hdc, 0, 0, Me.ScaleX(picEmoticon(index).Width, 1, 3), Me.ScaleY(picEmoticon(index).Height, 1, 3))
'picEmoticon(Index).Line (picEmoticon(Index).Width - 10, 10)-(picEmoticon(Index).Width - 10, picEmoticon(Index).Height - 10) 'right line
'picEmoticon(Index).Line (10, 10)-(picEmoticon(Index).Width - 10, 10) 'top line
End Sub

Private Sub picEmoticon_MouseMove(index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
If index = iOldIndex Then Exit Sub


Dim iX As Integer, iY As Integer, iPicW As Integer, iPicH As Integer
iPicW = imglstSmiley.ListImages(index).Picture.Width
iPicH = imglstSmiley.ListImages(index).Picture.Height
iX = (picEmoticon(index).Width / 2) - (iPicW / 4)
If iX < 0 Then iX = (iPicW / 2) - (picEmoticon(index).Width / 2)
iY = (picEmoticon(index).Height / 2) - (iPicH / 4)
If iY < 0 Then iY = (iPicH / 2) - (picEmoticon(index).Height / 2)

picEmoticon(index).BackColor = &H80000010
imglstSmiley.ListImages(index).Draw picEmoticon(index).hdc, iX, iY, 1

'picEmoticon(Index).Line (picEmoticon(Index).Width - 10, 10)-(picEmoticon(Index).Width - 10, picEmoticon(Index).Height - 10) 'right line
'picEmoticon(Index).Line (10, 10)-(picEmoticon(Index).Width - 10, 10) 'top line

If iOldIndex <> 0 Then
    iPicW = imglstSmiley.ListImages(iOldIndex).Picture.Width
    iPicH = imglstSmiley.ListImages(iOldIndex).Picture.Height
    iX = (picEmoticon(iOldIndex).Width / 2) - (iPicW / 4)
    If iX < 0 Then iX = (iPicW / 2) - (picEmoticon(iOldIndex).Width / 2)
    iY = (picEmoticon(iOldIndex).Height / 2) - (iPicH / 4)
    If iY < 0 Then iY = (iPicH / 2) - (picEmoticon(iOldIndex).Height / 2)

    picEmoticon(iOldIndex).BackColor = vbWhite 'check for first time hover
    imglstSmiley.ListImages(iOldIndex).Draw picEmoticon(iOldIndex).hdc, iX, iY, 1
    'picEmoticon(iOldIndex).Line (picEmoticon(Index).Width - 10, 10)-(picEmoticon(Index).Width - 10, picEmoticon(Index).Height - 10) 'right line
    'picEmoticon(iOldIndex).Line (10, 10)-(picEmoticon(Index).Width - 10, 10) 'top line
    
    Call Rectangle(picEmoticon(index).hdc, 0, 0, Me.ScaleX(picEmoticon(index).Width, 1, 3), Me.ScaleY(picEmoticon(index).Height, 1, 3))
    Call Rectangle(picEmoticon(iOldIndex).hdc, 0, 0, Me.ScaleX(picEmoticon(iOldIndex).Width, 1, 3), Me.ScaleY(picEmoticon(iOldIndex).Height, 1, 3))
End If

    'picEmoticon(1).Line (10, 10)-(10, picEmoticon(1).Height - 10) 'left line
    'picEmoticon(10).Line (10, 10)-(10, picEmoticon(10).Height - 10) 'left line
    'picEmoticon(19).Line (10, 10)-(10, picEmoticon(19).Height - 10) 'left line
    
iOldIndex = index
iOldMouseX = x
iOldMouseY = y

picEmoticon(index).SetFocus

End Sub

